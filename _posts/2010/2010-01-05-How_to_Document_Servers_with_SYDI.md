---
layout: single
title: How to Document Servers with SYDI
excerpt: 
permalink: /2010/12/how-to-document-servers-with-sydi_23.html
tags: 
- documentation
- inventory
- sydi
- vbscript
published: true
comments: true
---
<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Having written SYDI from scratch, I know it inside and out. Unfortunately I donâ€™t think Iâ€™ve managed to communicate how SYDI works in an efficient way. The readme file included in SYDI is far from perfect. While people in this line of business can usually figure out how it works, others will just ignore reading the manual anyway. In this how-to I will go through the basics of how SYDI-Server works and then describe how I use SYDI-Server.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Getting the Software</b><div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-size: 10.5pt;">You probably have the software already, but just in case. Download it from the <span style="font-size: 10.5pt;"><a href="http://sydi.sourceforge.net/" title="Home of SYDI"><u>SYDI website</u></a>, or if you love this site and donâ€™t want to leave it no matter what: you can download it from <a href="http://ogenstad.net/software/sydi/" title="SYDI"><u>here</u></a><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">. This guide is written for SYDI-Server 2.0, if there is a newer version when you read this, donâ€™t worry; it should be useful anyway. Just be sure to check the changelog.txt file for new features.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Unzip the file to your target directory.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Running SYDI in default mode</b><div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To see what the software does, open a command prompt and navigate to your sydi directory. This step requires you to have Microsoft Word installed on your computer. Type the command:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs [enter]<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">A message box appears and asks you which host you want to target, the default is localhost. You can select another host if you have administrative access on that machine. Though for now, just press enter.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">In the command prompt window you will now see that SYDI starts to gather information about your machine. Soon a Word document is created and SYDI writes the information gathered into the document.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Take a look at the document. Not all this information will be relevant to you and you can remove the parts you donâ€™t want by reading further. Close Word, or save the file it if you want to.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">The Options</b><div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To view the available options use the help command (-h):<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -h [enter]<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Options in five categories will be listed; Gathering, Output, Word, XML and Other. In reality there are only two, Gathering and Output.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Gathering the Information</b><div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Breaking down the gathering option we have five different arguments -w for WMI options, -r for Registry options and -u and -p for username and password if you want to connect to a different user. Finally we have the -t option where you specify which host you want to target against.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Looking closer at the -w argument from the help menu (-h) you could see that SYDI defaults to using <span class="scriptChar"><span style="font-family: 'Lucida Console';">-wabefghipPqrsSu<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">, meaning everything gathered from the WMI providers will be included.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">You cannot remove everything from the report, but letâ€™s create a document without all the extra information. Run:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -w [enter]<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">As you can see the report created is much shorter than the previous one. We have removed the optional WMI providers, but we still have the basic ones and the information coming from the Registry.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To choose which options you want, just check the help menu and see what they mean. If we want to add Bios Information, Printers and Services we would run:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -wbps [enter]<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">This way you can pick and choose the options you want. The Registry switch works the same way. For an even smaller report you can run:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -w -r [enter]<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Now you can add the registry options that you want. Please note though that a lot of the â€œComputer Rolesâ€ are gathered from the Windows Components, so if you want these roles you must have the Windows Components in your report (<span class="scriptChar"><span style="font-family: 'Lucida Console';">-rc<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">).<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Using the -t option removes the message box asking you which host you want to target. A few examples of using the <span class="scriptChar"><span style="font-family: 'Lucida Console';">-t<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> switch:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -tServer1
cscript.exe sydi-server.vbs -tDC1
cscript.exe sydi-server.vbs -tWebServer
cscript.exe sydi-server.vbs -t192.168.0.10<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;">
<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">The user and password options should work as you would expect them to, if they donâ€™t: report the bug to me<a href="http://lh6.ggpht.com/_wma7RYUNbDg/TRPwOpe8jXI/AAAAAAAA1VY/aBemBHSesNc/s1600-h/clip_image001%5B10%5D%5B2%5D.gif"></a><div class="MsoNormal" style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Word Options</b><div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">As youâ€™ve seen, sydi-server defaults to writing output to Word. The reason for this is so that you can get a quick overview of what the script can collect without having to do any tricks. Having said that, I only use the Word option to get a quick view of a machine, later I throw away the document. I always use the XML format which I later convert to a Word document, more on that later. Even though you wonâ€™t use the Word options much weâ€™ll just take a quick look at them to see what you can do, it wonâ€™t be a total waste as a few of the options are used by another script called <span class="scriptChar"><span style="font-family: 'Lucida Console';">ss-xml2word.vbs<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-b<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">is for the border of the tables created in the document. As you might have noticed there isnâ€™t any borders by default (when you print the document). You can use all borders you have installed in Word. To test it, type:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">cscript.exe sydi-server.vbs -bâ€Table Contemporaryâ€ [enter]<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-f<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">is if you want different font sizes, the default font size for the text is 12. To change it, use:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -f8<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-d<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">tells SYDI not to display Word until the entire report is written. Using the -d option makes the process go faster. Also if you want to save the file (-o option, more on that later), you might not want to see Word at all. For example if you are running a scheduled task you donâ€™t want a GUI to be loaded.<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-n<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">will remove all the text inside the brackets, such as â€œLogical location: [provide info: Server VLAN 2]â€œ. This way you wonâ€™t have a bad conscience about not completing the documentation.<a href="http://lh3.ggpht.com/_wma7RYUNbDg/TRPwQB4XG8I/AAAAAAAA1Vo/ydPXYWQUmGI/s1600-h/clip_image001%5B11%5D%5B2%5D.gif"></a> But as I have already stated, the whole idea of sydi-server writing directly to word is obsolete. If you start changing the document after it is created and want to run SYDI again your changes will be lost, or you will have to cut and paste them to the new document. There is a way around this though (hint: continue reading!).<div class="MsoNormal" style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-T<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">This is if you want to specify a corporate Word Template file (.dot), which enables you to choose which fonts you want to have as well as their size. This way you can get your â€œlook and feelâ€ in the document.<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">The Output Options</b><div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">SYDI has two output options; one for saving the report and another to choose which format to use.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-o<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">Output to file, specify a path and filename and use quotation marks if thereâ€™s a space in the path. Remember to give your file an .xml extension if youâ€™re using the XML format and a .doc extension for the Word format.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-e<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> <span style="color: #111111; font-size: 10.5pt;">This is to choose the export format, the default is -ew (Word), to change to XML use -ex.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To create an XML report you would use:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -oServer1.xml -ex [enter]<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">This will create an XML file that you can open in a browser.<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">XML Options</b><div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">You might have noticed that the XML file you created didnâ€™t look that great when viewed in your favorite browser. The reason is that youâ€™re just looking at the raw XML file.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To view a style sheet, use the <span class="scriptChar"><span style="font-family: 'Lucida Console';">-s<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> option. I generally use the <span class="scriptChar"><span style="font-family: 'Lucida Console';">-sh<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> option which uses the html style sheet included in SYDI. For advanced users there is a <span class="scriptChar"><span style="font-family: 'Lucida Console';">-st<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> option where you can specify a style sheet you have created on your own.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Letâ€™s test it again:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-server.vbs -oServer1.xml -ex -sh [enter]<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">In order to view this file with a browser you will need the <span class="scriptChar"><span style="font-family: 'Lucida Console';">serverhtml.xsl<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> and <span class="scriptChar"><span style="font-family: 'Lucida Console';">sydi-html-styles.xsl<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> to be located in the same directory. These files are in the XML subdirectory of SYDI-Server. Copy the <span class="scriptChar"><span style="font-family: 'Lucida Console';">Server1.xml<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> file you just created to that directory and open the file in a browser. Alternatively you can copy all of these files to another directory.<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">What Other Options do you have?</b><div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To be honest, you donâ€™t have that many. The options that are left are <span class="scriptChar"><span style="font-family: 'Lucida Console';">-v<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> to check the version of your script; this will check the SYDI website and see if a later version is available (I might remove this option).<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">The last option is -d for debug, if something fails to run as you expect it might be because of a bug in SYDI. The <span class="scriptChar"><span style="font-family: 'Lucida Console';">-d<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> option is useful to troubleshoot these scenarios.<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">What if You Have More Than One computer?</b><div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">So you want to run SYDI against multiple computers, itâ€™s easy enough to write a batch file that does it for you. However, in the Tools directory there is a script called <span class="scriptChar"><span style="font-family: 'Lucida Console';">sydi-wrapper.vbs<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">. A little â€œgotchaâ€ is that you have to edit the script for it to work, but donâ€™t panic; there isnâ€™t any voodoo involved. Just open the script in notepad and scroll down to this section:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">â€˜ Gathering Options
â€˜ WMI â€“ Everything enabled by default
WMIOPTIONS=â€-wabefghipPqrsSuâ€
â€˜ Registry â€“ Everything enabled by default
REGISTRYOPTIONS=â€-racdlpâ€<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">â€˜ Export Options
â€˜EXPORTFORMAT=â€wordâ€ â€˜ For Microsoft Word
EXPORTFORMAT=â€xmlâ€ â€˜ For XML<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';"><span style="font-size: 9pt;">â€˜ Location Options
â€˜ Location of SYDI-Server.vbs
SYDISERVER=â€C:\scripts\sydi-server.vbsâ€
OUTPUTDIRECTORY=â€C:\scripts\Output files\â€
LOGDIRECTORY=â€C:\Scripts\Log Files\â€
TIMEOUT=â€600<span style="font-size: 9pt;"><span style="font-family: 'Courier New';">â€³<span style="font-family: 'Lucida Console';"><span style="font-size: 9pt;"> â€˜ How many seconds you have to wait until a computer-scan is aborted hasnâ€™t been tested.<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';"><span style="font-size: 9pt;">â€˜ Other options, check sydi-server.vbs -h for help
â€˜ Uncoment/Change One of the below
OTHEROPTIONS=â€-shâ€ â€˜ For HTML Stylesheet on XML output
â€˜OTHEROPTIONS=â€-b10<span style="font-size: 9pt;"><span style="font-family: 'Courier New';">â€³<span style="font-family: 'Lucida Console';"> â€˜ Base Font size of 12
â€˜ End Of Settings<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">You will recognize the <span class="scriptChar"><span style="font-family: 'Lucida Console';">-w<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> and <span class="scriptChar"><span style="font-family: 'Lucida Console';">-r<span style="font-family: Arial;"><span style="font-size: 10.5pt;"> options, unlike SYDI-Server this script defaults to XML (as it should). What you<span class="apple-converted-space"><b>must</b><span class="apple-converted-space">change in order to get this to work are the values for SYDISERVER, OUTPUTDIRECTORY and LOGDIRECTORY. If you want to you can change the TIMEOUT value too, however it might not do you any good. That feature seems to have taken<span class="apple-converted-space"><span style="font-size: 10.5pt;"><a href="http://en.wikipedia.org/wiki/Software_bug" title="Bug"><u>time out</u></a><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">I wasnâ€™t sure this was a good way to implement the script. The reason you have to edit the script is so that you wonâ€™t have to write such long commands later on in order to get it working.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Anyway, the remaining options are <span class="scriptChar"><span style="font-family: 'Lucida Console';">-u<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> and <span class="scriptChar"><span style="font-family: 'Lucida Console';">-p <span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">for username and password when you connect to the machines. Then there are the gathering options or source options.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-t<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> Reads from a text file, the computers listed in the text file should be separated by line or comma. To use this option:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">cscript.exe sydi-wrapper.vbs -tAllMyComputers.txt<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-d<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> This is to get computers from a flat domain (NT4 style) to connect to all the computers in the domain you specify. A word of warning though, Iâ€™m told Heaven will be closing the gates for people who use NT4 much longer (you might have to break in as it is).<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">-a<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> Active Directory, if you just run the script with <span class="scriptChar"><span style="font-family: 'Lucida Console';">-a<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> it will connect to the active directory domain where your machine is located. Your other option is to specify an LDAP container. SYDI-Server will then scan all computers under this container (except for the ones with disabled computer accounts).<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">A few examples:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">cscript sydi-wrapper.vbs -aDC=exibice,DC=com
cscript sydi-wrapper.vbs -aâ€OU=Member Servers,DC=exibice,DC=comâ€<div style="line-height: normal; margin: 0in 0in 0pt;"><i style="mso-bidi-font-style: normal;"><span style="font-family: Arial;"><span style="font-size: 10.5pt;">[Self Promotion Mode]
If you havenâ€™t heard of Exibice thereâ€™s a whole story about the company, read the first part<span class="apple-converted-space"></i><span style="font-size: 10.5pt;"><a href="http://ogenstad.net/2006/07/20/the-tale-of-the-disgruntled-employee-part-1/" title="The Tale of the Disgruntled Employee"><i style="mso-bidi-font-style: normal;"><u>here</u></i></a><span style="font-family: Arial;"><span class="apple-converted-space"><i style="mso-bidi-font-style: normal;"></i><i style="mso-bidi-font-style: normal;">and youâ€™ll find the other parts<span class="apple-converted-space"></i><a href="http://ogenstad.net/stories" title="The other parts"><i style="mso-bidi-font-style: normal;"><u>here</u></i></a><i style="mso-bidi-font-style: normal;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">.
[/Self Promotion Mode]</i><div style="line-height: normal; margin: 0in 0in 0pt;">
<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">An Eagles View</b><div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">After running <span class="scriptChar"><span style="font-family: 'Lucida Console';">sydi-wrapper<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> you might have ended up with a whole lot of XML files. To give you a quick overview Iâ€™ve included a script for just this purpose. Also in the Tools directory is the sydi-overview.vbs script. It accepts one argument, <span class="scriptChar"><span style="font-family: 'Lucida Console';">-x<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">, you will want to point this to the output directory you specified in sydi-wrapper. I have created a batch file which reads:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-overview.vbs -x\\fileserver\net$\sydi\output<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Running the script requires that you have Microsoft Excel installed on your machine. The script will parse all the XML files and start to populate the cells in Excel. The script will create six sheets. Computers with basic information about all your computers, WMI Programs is a list of all software installed by Windows Installer, Reg Programs are the ones found in the Uninstall registry key, Processes tells you what every computer is running. All these can be good to detect rouge programs or processes.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Finally there is the OS distribution pie chart and data source.<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Wasnâ€™t There an Option for Html?</b><div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">I might have said there was at some time, but it was a white lie. What you can do is to convert the XML file into a Html document. Itâ€™s quite easy and itâ€™s used in this way:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe sydi-transform.vbs -xServer.xml -sServerhtml.xsl -oServer.html<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Running this script will require that <span class="scriptChar"><span style="font-family: 'Lucida Console';">Server.xml<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> and <span class="scriptChar"><span style="font-family: 'Lucida Console';">Serverhtml.xsl<span style="font-family: Arial;"><span class="apple-converted-space"><span style="font-size: 10.5pt;"><span style="font-size: 10.5pt;"><b>and</b><span class="apple-converted-space"><span style="font-size: 10.5pt;"><span class="scriptChar"><span style="font-family: 'Lucida Console';">sydi-html-stylex.xsl<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> are located in the same directory. If you have created private xsl files you can use the sydi-transform to convert it.<div style="line-height: normal; margin: 0in 0in 0pt;">
<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Hey, Wasnâ€™t This about Documentation?</b><div style="line-height: normal; margin: 0in 0in 0pt;">
<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">It sure was, most of what weâ€™ve looked at up until now has been more geared against Inventory instead of Network Documentation. I saved the best for last; a new tool in sydi-server 2.0 is the <span class="scriptChar"><span style="font-family: 'Lucida Console';">ss-xml2word.vbs<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> script (or SYDI-Server XML to Word).<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">What the script does is that it takes an XML file and converts it to a Word document. You might be thinking that SYDI already wrote to Word, which is true, however there are situations where that isnâ€™t possible. For example in environments where you donâ€™t have Word installed, may it be in a DMZ or as a scheduled task on a server.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">The good part though is the options you specify when creating the Word document. To view these options run:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe ss-xml2word.vbs -h<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Here you can see that there are two arguments that are required <span class="scriptChar"><span style="font-family: 'Lucida Console';">-x<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> and <span class="scriptChar"><span style="font-family: 'Lucida Console';">-l<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe ss-xml2word.vbs -xServer1.xml -llang_english.xml<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="font-size: 10.5pt;">This line will create a Word document based on the information in the file, it will then use the English language file which describes what it writes to the Word document. This means that you can have the documentation in your native language. When I released SYDI-Server 2.0 there was support for English and Swedish. Later people have contributed with there own language files which you can download;<span class="apple-converted-space"><span style="font-size: 10.5pt;"><a href="http://ogenstad.net/2006/07/03/sydi-server-speaks-italian/" title="Italian"><u>Italian</u></a><span style="font-size: 10.5pt;"><span style="font-family: Arial;">,<span class="apple-converted-space"><a href="http://ogenstad.net/2006/08/07/document-your-servers-in-norwegian/" title="Norwegian"><u>Norwegian</u></a>,<a href="http://ogenstad.net/2006/09/06/network-documentation-for-the-dutch-and-portuguese/" title="Portuguese and Dutch"><u>Portuguese and Dutch</u></a><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">One issue that causes the ss-xml2word.vbs script to fail for many people is a path problem. If you run the script and it just writes out a few pages without any information from the xml file and the script crashes, this is happening to you. Either put all the files in the same directory or specify the path after -x -l or -s. I will fix this in future versions so the error message is a bit more user-friendly.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">The most exciting feature as I see it is the optional -s argument. This is the reason I created SYDI in the first place. The -s option specifies an XML file which contains the written documentation about the server. That is the documentation you have created, this differs from the data that SYDI-Server has gathered from the machine.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Letâ€™s take it for a spin.<div style="line-height: normal; margin: 0in 0in 0pt;"><b><span style="font-family: Arial;">Writing Your Documentation</b><div style="line-height: normal; margin: 0in 0in 0pt;">
<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">To get you started Iâ€™ve included three files in the Examples directory (of sydi-server), copy the <span class="scriptChar"><span style="font-family: 'Lucida Console';">howto.xml<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;"> and rename it to <span class="scriptChar"><span style="font-family: 'Lucida Console';">Server1_docs.xml<span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">. This will be where you will write the documentation. Open the Server1_docs.xml file in Notepad. Scrolling up and down you will see different XML tags. Youâ€™ll recognize the sections and subsections from the Word documents previously created.<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Inside the sections and subsections you will see prenotes and postnotes, inside these there are a few tags. The only thing you have to do in this file is to create and edit tags. Scroll down to the section called toc (Tables of Contents), here you will see the difference between prenotes and postnotes. It has to do where they appear in the final document. Just run a few tests and youâ€™ll se what I mean. So letâ€™s start to document.<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">In the system info section change this:
In this version you are only able to use text tags, more could be available in later versions of SYDI.To:<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Physical Location: Server Room in Stockholm
System Owner: BOFH
Support Agreement: 3Y Next Business Day (Expires 2007-10-16)<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Save the file and create the final document.<div style="line-height: normal; margin: 0in 0in 0pt;">
<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">Cscript.exe ss-xml2word.vbs -xServer1.xml -llang_english.xml -sServer1_docs.xml<div style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">The above was just an example, you are of course free to write and include whatever you want in the documentation. If you fail to create the documents itâ€™s good to know that XML parsers are very unforgiving if thereâ€™s an error in any of the files. Make sure all tags are closed correctly by opening them in a browser. If you fail to open Server1_docs.xml in a browser the problem is there. Fix it and try again.<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">Iâ€™ve also created a batch file, <b style="mso-bidi-font-weight: normal;">writedoc.cmd</b> which looks like this:<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;">
<span style="font-family: 'Lucida Console';">cscript.exe tools\ss-xml2word.vbs -x\\serverr\net$\sydi\output\%1.xml -llanguage\lang_english.xml -s\\server\itsupport$\documentation-source\%1-written.xml -o\\server\itsupport$\documentation-binder\Server-%1.doc -d -bâ€Table Contemporaryâ€<div style="line-height: normal; margin: 0in 0in 0pt;">
<div style="line-height: normal; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="color: #111111; font-size: 10.5pt;">I use it by running<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;">
<span style="font-family: 'Lucida Console';">Writedoc.cmd Servername<div class="script" style="line-height: normal; margin: 0in 0in 18.85pt;"><span style="font-family: 'Lucida Console';">
