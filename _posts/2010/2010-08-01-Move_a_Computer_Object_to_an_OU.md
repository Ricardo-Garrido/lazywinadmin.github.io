---
layout: single
title: Move a Computer Object to an OU
excerpt: 
permalink: /2010/12/how-to-find-computer-serial-number.html
tags: 
- active directory
- scripting
- vbscript
published: true
comments: true
---
<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial; font-size: 10pt;">I'm currently working on the configuration of HP Rapid Deployment Pack (RDP) and I had to create a task who will automatically move the Computer object in the good OU.<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;">
<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: black; font-family: Arial; font-size: 10pt;">So I want to move a computer object to the good OU depending of the SERVERNAME<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><span style="font-size: 10pt;">In my company we use the name convention <b><u><span style="font-size: 10pt;">MTL1ASTT01:</u></b><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><b><u><br style="mso-special-character: line-break;" /><span style="font-family: Arial;"></u></b><blockquote><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><b><u><span style="font-size: 10pt;">MTL</u></b><span style="font-size: 10pt;"><b></b><span style="font-size: 10pt;">is the city name</blockquote><blockquote><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><b><u><span style="font-size: 10pt;">1 </u></b><span style="font-size: 10pt;">is the site number</blockquote><blockquote><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><b><u><span style="font-size: 10pt;">A</u></b><span style="font-size: 10pt;"> for application</blockquote><blockquote><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><b><u><span style="font-size: 10pt;">STT</u></b><span style="font-size: 10pt;"> custom info</blockquote><blockquote><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="font-family: Arial;"><b><u><span style="font-size: 10pt;">01</u></b><span style="font-size: 10pt;"> number of the server</blockquote><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: black; font-family: Arial; font-size: 10pt;">In our Active Directory we use:<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;">
<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: black; font-family: Arial; font-size: 10pt;"><strong>DOMAIN.local > GLOBAL > %SITENAME% > SERVERS</strong><div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;">
<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: black; font-family: Arial; font-size: 10pt;">So if want to get the SITENAME and the SITENUMBER from the SERVERNAME i would use the code below, it will select<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;">
<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="background-color: #cccccc; color: black; font-family: Arial; font-size: 10pt;"><span style="color: green; font-family: 'Lucida Console'; font-size: 10pt;">echo. Getting Sitename from the Computer name ...<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Lucida Console'; font-size: 10pt;">Set SITENAME=%COMPUTERNAME%:0,4%<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Lucida Console'; font-size: 10pt;">echo. SITENAME is %SITENAME%<div class="MsoNormal" style="background: white; line-height: 14.25pt; margin: 0in 0in 0pt;"><span style="color: green; font-family: 'Lucida Console'; font-size: 10pt;">dsmove "CN=%COMPUTERNAME%,OU=COMPUTERS,DC=DOMAIN,DC=LOCAL" -newparent OU=Servers,OU=%SITENAME%,OU=GLOBAL,DC=DOMAIN,DC=LOCAL<div class="MsoNormal" style="line-height: 13pt; margin: 0in 0in 0pt;">
<div class="MsoNormal" style="line-height: 13pt; margin: 0in 0in 0pt;">More information about <a href="http://technet.microsoft.com/en-us/library/cc731094(WS.10).aspx" target="_blank">DSMOVE</a>
